---
title: "记录优化furry随机图api的过程"
published: 2025-09-06T13:53:00+08:00
updated: 2025-10-25T14:53:38+08:00
description: ""
tags: []
category: "未分类"
image: ""
---
各位豪！
众所周知，我对于一个快速的api是**有着追求**的  ~~（其实是有一点强迫症） ~~，所以furry随机图api在前期经过了**多次切换cdn**，甚至是**切换后端语言**的情况。
话不多说，让我们开始吧！
***
### 变更一：后端语言切换
在早期的时候，api后端（即返回随机图的服务）采**用的是php**，并发**性能低**，且系统**资源消耗大**，为了解决这一个问题，我选择**重写后端**，改为**使用go语言**，而后经过我的测试，效率大大的提高了（~3x-5x），具体会表现在**超大量**访问时**失败率下降**等方面，同时也不会出现像是使用php时会出现的莫名重启服务的现象~~（虽然有可能是因为我早期时用的系统的原因）~~
### 变更二：CDN的切换
api所使用的cdn目前**经历过七次切换**，过程为：
` Cloudflare → 失控的防御系统 → Cloudflare优选 → 直连源站 → Edgeone → 自建简易cdn`
在最早期（2024.12.8）的时候，Cloudflare的表现是很不错的，同时我付费开启了Smart Argo Routing功能，实现了基本的中国绿，但是好景不长，从2024.12.20日开始，Cloudflare开始将部分大流量高访问的网站分配到类似104.21.\*.1的ip，至此我开始了切换cdn的路。
通过查找，我找到了一个**价格低廉**，**速度还不错亚太cdn**，叫做**失控的防御系统**，不过在使用一段时间后，我发现一个**致命的问题**：cdn的ip中有部分是**被标记过**的，会导致新域名**被反诈**之类的（也可能是我的问题orz），因此在权衡后我选择了切换至Cloudflare优选。
好景不长，有人在聊天群组中汇报使用Cloudflare的***速度感人***，因此我选择**暂时**切换为**直连源站**，并查找替代的产物。
也就是那一段时间，Edgeone出现了，经过测试**速度还不错**。但是我的域名在内蒙古等地区**会出现无法访问**的情况，导致每次进行itdog网站测试，都会**出现一块红红**的，看的我***十分有九分的难受***。
于是我决定**进行一个简单的自建**，通过查询，[SkyWolf](https://hk.skywolf.cloud/aff.php?aff=57)家的香港机器是个**不错的选择**，去程走的**优化线路**，而且**价格足够低**，同时考虑到内地地区，我便购买了一台新加坡的，一台香港的用来做加速节点。
通过配置nginx和certbot，我实现了**加速访问**和**自动证书**签发功能，然后就不再变动，也就有了现在的api速度
在自建时，考虑过Dmit的机器，但是都是我**负担不起的价格**，也就没有使用，同时也考虑过其他的cdn，但都是要么**价格过高**，要么**速度不好**所以最终还是采用自建了（

### 2025 10.25更新 

经过几个月的测试，速度依旧达不到我的要求，稳定性也并非很好，恰好我在idcflare上刷到了[这个帖子](https://idcflare.com/t/topic/17314?u=mingtone)，而且也十分凑巧的，我抽中了三个月。
在10.24，我发送了一个测试用的域名到了tg群组内，询问速度如何 *虽然没有人回我* 但是从itdog等多方面测速的结果来看，确实是一家不错的cdn，于是在10.25凌晨，我切换至了这一家cdn，相信你们对于api速度的改进会有很大的感受（（

---
好了不说了，这篇文章就到这了，下面是api的图片~
[![Api图片](https://api.furry.ist/furry-img/?nocache=2981y498712438749y384y8y)](https://api.furry.ist/)
